<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="fr" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Analyse et prévisions en temps réel des épidémies avec R: Simuler des chaînes de transmission</title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="../assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="../assets/styles.css"><script src="../assets/scripts.js" type="text/javascript"></script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-XZ471458FQ');
    </script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../favicons/epiverse-trace/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicons/epiverse-trace/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="../favicons/epiverse-trace/favicon-16x16.png"><link rel="manifest" href="../favicons/epiverse-trace/site.webmanifest"><link rel="mask-icon" href="../favicons/epiverse-trace/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav epiverse-trace"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Passer au contenu principal</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="epiverse-trace-logo" alt="epiverse-trace" src="../assets/images/epiverse-trace-logo.svg"><span class="badge text-bg-danger" style="background-color: #FF4955; border-radius: 5px">
          <abbr title="Cette leçon est en version pre-alpha, ce qui signifie qu'elle est au début de son développement, mais n'a pas encore été enseignée.">
            <a href="https://docs.carpentries.org/resources/curriculum/lesson-life-cycle.html" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">Cette leçon est en version pre-alpha, ce qui signifie qu'elle est au début de son développement, mais n'a pas encore été enseignée.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Changer de thème (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Vue Instructeur <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='../superspreading-simulate.html';">Vue Apprenti</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav epiverse-trace" aria-label="Navigation Principale"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Afficher/cacher la barre de navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="epiverse-trace" src="../assets/images/epiverse-trace-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Analyse et prévisions en temps réel des épidémies avec R
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Rechercher dans la page 'All In One'" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Analyse et prévisions en temps réel des épidémies avec R
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Points clés</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Notes de l'instructeur</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extraire toutes les images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            Voir plus <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><hr><li><a class="dropdown-item" href="reference.html">Glossary of Terms: Epiverse-TRACE</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Rechercher dans la page 'All In One'"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Rechercher dans la page 'All In One'">Rechercher dans la page 'All In One'</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Analyse et prévisions en temps réel des épidémies avec R
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 86%" class="percentage">
    86%
  </div>
  <div class="progress epiverse-trace">
    <div class="progress-bar epiverse-trace" role="progressbar" style="width: 86%" aria-valuenow="86" aria-label="Avancée de la leçon" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="fermer le menu" alt="fermer le menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Cacher " data-episodes="Épisodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Vue Instructeur
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../superspreading-simulate.html">Vue Apprenti</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  ÉPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Résumé et Emploi du Temps</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="delays-access.html">1. Accéder aux distribution des délais épidémiologiques</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="quantify-transmissibility.html">2. Quantifier la transmission</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="delays-functions.html">3. Utiliser les distributions de délais dans l'analyse</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="create-forecast.html">4. Établir des prévisions à court terme</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="severity-static.html">5. Estimation de la gravité d'une épidémie</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="superspreading-estimate.html">6. Tenir compte du phénomène hypercontagieux</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        7. Simuler des chaînes de transmission
        </span>
      </button>
    </div><!--/div.accordion-header-->

    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#introduction">Introduction</a></li>
<li><a href="#simulation-des-%C3%A9pid%C3%A9mies-incontr%C3%B4l%C3%A9es">Simulation des épidémies incontrôlées</a></li>
<li><a href="#obtenez-la-distribution-de-la-descendance">Obtenez la distribution de la descendance</a></li>
<li><a href="#obtenir-le-temps-de-g%C3%A9n%C3%A9ration">Obtenir le temps de génération</a></li>
<li><a href="#simuler-une-cha%C3%AEne-unique">Simuler une chaîne unique</a></li>
<li><a href="#simuler-plusieurs-cha%C3%AEnes">Simuler plusieurs chaînes</a></li>
<li><a href="#r%C3%A9p%C3%A9ter-les-simulations">Répéter les simulations</a></li>
<li><a href="#visualiser-plusieurs-cha%C3%AEnes">Visualiser plusieurs chaînes</a></li>
<li><a href="#d%C3%A9fis">Défis</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESSOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="../instructor/key-points.html">Points clés</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Notes de l'instructeur</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extraire toutes les images</a>
                      </li>
                      <hr><li><a class="dropdown-item" href="reference.html">Glossary of Terms: Epiverse-TRACE</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources"><a href="../instructor/aio.html">Voir tout sur une seule page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Chapitre Précédent et Suivant"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/superspreading-estimate.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Précédent</a>
        <a class="chapter-link float-end" href="../instructor/index.html">Suivant<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/superspreading-estimate.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Précédent: Tenir compte du
        </a>
        <a class="chapter-link float-end" href="../instructor/index.html" rel="next">
          Accueil
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Simuler des chaînes de transmission</h1>
        <p>Dernière mise à jour le 2025-11-02 |

        <a href="https://github.com/epiverse-trace/tutorials-middle-fr/edit/main/episodes/superspreading-simulate.Rmd" class="external-link">Modifier cette page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <p>Durée estimée : <i aria-hidden="true" data-feather="clock"></i> 32 minutes</p>

        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Afficher toutes les solutions " data-collapse="Cacher toutes les solutions "> Afficher toutes les solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Vue d'ensemble</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>Comment simuler des chaînes de transmission basées sur les
caractéristiques de l’infection ?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectifs</h3>
<ul><li>Estimez le potentiel d’épidémies importantes suite à l’introduction
d’un nouveau cas à l’aide d’un processus de ramification avec
<a href="https://github.com/epiverse-trace/epichains" class="external-link">epichains</a>.</li>
</ul></div>
</div>
</div>
</div>
</div>
<div id="conditions-préalables" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div id="conditions-préalables" class="callout-inner">
<h3 class="callout-title">Conditions préalables</h3>
<div class="callout-content">
<p>Les apprenants devraient se familiariser avec les concepts suivants
avant de suivre ce tutoriel :</p>
<p><strong>Statistiques</strong> Les distributions de probabilités
courantes, y compris les distributions de Poisson et binomiale
négative.</p>
<p><strong>Théorie des épidémies</strong>: Le nombre de reproduction,
<span class="math inline">\(R\)</span>.</p>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a></h2>
<hr class="half-width"><!-- ce que nous savons --><p>La variation individuelle de la transmission peut affecter à la fois
le potentiel d’établissement d’une épidémie dans une population et la
facilité de sa contrôle (<a href="https://royalsocietypublishing.org/doi/10.1098/rstb.2016.0371" class="external-link">Cori
et al., 2017</a>).</p>
<ul><li><p>Une plus grande variation réduit la probabilité globale qu’un
nouveau cas unique soit à l’origine d’une épidémie locale de grande
ampleur, car la plupart des cas infectent peu d’autres personnes et les
individus qui génèrent un grand nombre de cas secondaires sont
relativement rares.</p></li>
<li><p>Toutefois, si un “événement de super propagation” se produit et
que l’épidémie s’installe, cette variation peut rendre l’épidémie plus
difficile à contrôler en utilisant <em>des interventions de masse</em>
(c’est-à-dire des interventions générales qui supposent implicitement
que tout le monde contribue de manière égale à la transmission), car
certains cas contribuent de manière disproportionnée : un seul cas non
contrôlé peut générer un grand nombre de cas secondaires.</p></li>
<li><p>Inversement, la variation de la transmission peut offrir des
possibilités des <em>interventions ciblées</em> si les individus qui
contribuent le plus à la transmission (en raison de facteurs biologiques
ou comportementaux), ou les environnements dans lesquels se produisent
les “événements de super propagation”, partagent des caractéristiques
sociodémographiques, environnementales ou géographiques qui peuvent être
définies.</p></li>
</ul><!-- Ce que nous ne savons pas --><p>Comment peut-on quantifier le potentiel d’une nouvelle infection à
provoquer une épidémie de grande ampleur sur la base de son nombre de
reproduction <span class="math inline">\(R\)</span> et de la dispersion
<span class="math inline">\(k\)</span> de la distribution de sa
descendance ?</p>
<figure style="text-align: center"><img src="../fig/superspreading-simulate-rendered-unnamed-chunk-1-1.png" alt="Nombre observé de cas cumulés liés à l épidémie du syndrome respiratoire du Moyen-Orient (MERS) en Corée du Sud, en 2015, ainsi que les chaînes de transmission simulées en supposant une distribution des descendants avec $R=0.6$ et $k=0.02$." class="figure mx-auto d-block"><figcaption>
Nombre observé de cas cumulés liés à l épidémie du syndrome respiratoire
du Moyen-Orient (MERS) en Corée du Sud, en 2015, ainsi que les chaînes
de transmission simulées en supposant une distribution des descendants
avec <span class="math inline">\(R=0.6\)</span> et <span class="math inline">\(k=0.02\)</span>.
</figcaption></figure><!-- ce que nous allons faire --><p>Dans cet épisode, nous utiliserons le package
<a href="https://github.com/epiverse-trace/epichains" class="external-link">epichains</a> pour simuler des chaînes de transmission et
estimer le potentiel d’épidémies importantes suite à l’introduction d’un
nouveau cas. Nous allons l’utiliser avec les fonctions de
<a href="https://github.com/epiverse-trace/epiparameter/" class="external-link">epiparameter</a>, <a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a> et
<a href="https://purrr.tidyverse.org/" class="external-link">purrr</a>donc il faut également charger le
<a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a> package :</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">epichains</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">epiparameter</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
<div id="le-double-point-virgule" class="callout checklist">
<div class="callout-square">
<i class="callout-icon" data-feather="check-square"></i>
</div>
<div id="le-double-point-virgule" class="callout-inner">
<h3 class="callout-title">Le double point-virgule</h3>
<div class="callout-content">
<p>Le double point-virgule <code>::</code> en R vous permet d’appeler
une fonction spécifique d’un package sans charger le package entier dans
l’environnement courant.</p>
<p>Par exemple, vous pouvez appeler une fonction spécifique d’un package
sans charger le package entier dans l’environnement actuel,
<code>dplyr::filter(data, condition)</code> utilise
<code>filter()</code> à partir de l’outil <a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a>
package.</p>
<p>Cela nous permet de nous souvenir des fonctions du package et
d’éviter les conflits d’espace de noms.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="simulation-des-épidémies-incontrôlées">Simulation des épidémies incontrôlées<a class="anchor" aria-label="anchor" href="#simulation-des-%C3%A9pid%C3%A9mies-incontr%C3%B4l%C3%A9es"></a></h2>
<hr class="half-width"><p>Les épidémies de maladies infectieuses se propagent dans les
populations lorsqu’une chaîne d’individus infectés transmet l’infection
à d’autres. <a href="https://epiverse-trace.github.io/epichains/articles/theoretical_background.html" class="external-link">Processus
de ramification</a> peuvent être utilisés pour modéliser cette
transmission. Un processus de ramification est un processus stochastique
(c’est-à-dire un processus aléatoire qui peut être décrit par une
distribution de probabilité connue), dans lequel chaque individu
infectieux donne naissance à un nombre aléatoire d’individus dans la
génération suivante d’infection, en commençant par le cas index dans la
génération 1. La distribution du nombre de cas secondaires générés par
chaque individu est appelée distribution de la descendance (<a href="https://epiverse-trace.github.io/epichains/articles/epichains.html" class="external-link">Azam
&amp; Funk, 2024</a>).</p>
<p><a href="https://github.com/epiverse-trace/epichains" class="external-link">epichains</a> fournit des méthodes d’analyse et de
simulation de la <em>taille</em> et <em>longueur</em> des processus de
ramification pour une certaine distribution de la descendance.
<a href="https://github.com/epiverse-trace/epichains" class="external-link">epichains</a> met en œuvre un modèle simple et rapide pour
simuler les chaînes de transmission afin d’évaluer le risque épidémique,
de projeter les cas dans l’avenir et d’évaluer les interventions qui
modifient <span class="math inline">\(R\)</span>.</p>
<div id="taille-et-longueur-de-la-chaîne" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="taille-et-longueur-de-la-chaîne" class="callout-inner">
<h3 class="callout-title">taille et longueur de la chaîne</h3>
<div class="callout-content">
<ul><li><p>La <strong>taille</strong> de la chaîne de transmission est
définie comme le nombre total d’individus infectés sur toutes les
générations d’infection, et</p></li>
<li><p>la <strong>longueur</strong> de la chaîne de transmission est le
nombre de générations entre le premier et le dernier cas de l’épidémie
avant que la chaîne se termine.</p></li>
</ul><p>Le calcul de la <em>taille</em> inclut le premier cas, et le calcul
de la <em>longueur</em> contient la première génération lorsque le
premier cas commence la chaîne (voir figure ci-dessous).</p>
<figure><img src="https://raw.githubusercontent.com/epiverse-trace/epichains/main/vignettes/img/transmission_chain_example.png" alt="Exemple d’une chaîne de transmission commençant par un seul cas C1. Les cas sont représentés par des cercles bleus et des flèches indiquant qui a infecté qui. La chaîne se développe à travers les générations Gen 1, Gen 2 et Gen 3, produisant les cas C2, C3, C4, C5 et C6. La chaîne se termine à la génération Gen 3 avec les cas C4, C5 et C6. La taille de la chaîne de C1 est de 6, y compris C1 (c’est-à-dire la somme de tous les cercles bleus), et sa longueur est de 3, ce qui inclut la génération 1 (nombre maximal de générations atteint par la chaîne de C1) (Azam &amp; Funk, 2024)." class="figure mx-auto d-block"><div class="figcaption">
<strong>Exemple d’une chaîne de transmission
commençant par un seul cas C1.</strong> Les cas sont représentés par des
cercles bleus et des flèches indiquant qui a infecté qui. La chaîne se
développe à travers les générations Gen 1, Gen 2 et Gen 3, produisant
les cas C2, C3, C4, C5 et C6. La chaîne se termine à la génération Gen 3
avec les cas C4, C5 et C6. La taille de la chaîne de C1 est de 6, y
compris C1 (c’est-à-dire la somme de tous les cercles bleus), et sa
longueur est de 3, ce qui inclut la génération 1 (nombre maximal de
générations atteint par la chaîne de C1) (<a href="https://epiverse-trace.github.io/epichains/articles/epichains.html" class="external-link">Azam
&amp; Funk, 2024</a>).</div>
</figure></div>
</div>
</div>
<p>Pour utiliser <a href="https://github.com/epiverse-trace/epichains" class="external-link">epichains</a> nous devons connaître (ou
supposer) deux valeurs épidémiologiques clés : la distribution de la
descendance et le temps de génération.</p>
</section><section><h2 class="section-heading" id="obtenez-la-distribution-de-la-descendance">Obtenez la distribution de la descendance<a class="anchor" aria-label="anchor" href="#obtenez-la-distribution-de-la-descendance"></a></h2>
<hr class="half-width"><p>Nous supposons ici que la distribution de la descendance du MERS suit
une distribution binomiale négative, avec une moyenne (nombre de
reproduction <span class="math inline">\(R\)</span>) et une dispersion
<span class="math inline">\(k\)</span> estimées à partir de la liste et
des données de contact de <code>mers_korea_2015</code> dans le package
<a href="https://github.com/reconhub/outbreaks" class="external-link">outbreaks</a> R de l’épisode précédent.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mers_offspring</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0.60</span>, dispersion <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span></span></code></pre>
</div>
<div id="distribution-de-la-descendance-pour-épichains" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="distribution-de-la-descendance-pour-épichains" class="callout-inner">
<h3 class="callout-title">Distribution de la descendance pour épichains</h3>
<div class="callout-content">
<p>Nous entrons une distribution de descendance dans
<a href="https://github.com/epiverse-trace/epichains" class="external-link">epichains</a> en faisant référence à la fonction R qui génère
des valeurs aléatoires à partir de la distribution souhaitée. Pour une
distribution binomiale négative, nous utilisons <code>rnbinom</code>
avec les arguments <code>mu</code> et <code>size</code>:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>  offspring_dist <span class="ot">=</span> rnbinom,</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  mu <span class="ot">=</span> mers_offspring[<span class="st">"mean"</span>],</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  size <span class="ot">=</span> mers_offspring[<span class="st">"dispersion"</span>],</span></code></pre>
</div>
<p>En interne, <a href="https://github.com/epiverse-trace/epichains" class="external-link">epichains</a> tire une valeur aléatoire,
compte tenu des paramètres, afin de simuler le nombre de nouvelles
infections à partir d’un individu infecté (transmission ultérieure).</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate one random number given the distribution family and its parameters</span></span>
<span><span class="co"># (run this line many times to get different values)</span></span>
<span><span class="fu">rnbinom</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, mu <span class="op">=</span> <span class="va">mers_offspring</span><span class="op">[</span><span class="st">"mean"</span><span class="op">]</span>, size <span class="op">=</span> <span class="va">mers_offspring</span><span class="op">[</span><span class="st">"dispersion"</span><span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
<p>Le manuel de référence en <code>?rnbinom</code> nous indique les
arguments spécifiques requis.</p>
</div>
</div>
</div>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Poisson et autres distributions </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler1" aria-labelledby="headingSpoiler1">
<div class="accordion-body">
<p><a href="https://github.com/epiverse-trace/epichains" class="external-link">epichains</a> peut accepter n’importe quelle fonction R
qui génère des nombres aléatoires, de sorte que les arguments spécifiés
changeront en fonction de la fonction R utilisée. Pour plus de détails
sur les options possibles, consultez le manuel de référence de la
fonction.</p>
<p>Par exemple, disons que nous voulons utiliser une distribution de
Poisson pour la distribution de la descendance. Tout d’abord, lisez
l’argument requis <code>?rpois</code> dans le manuel de référence.
Ensuite, spécifiez l’argument <code>lambda</code> également connu sous
le nom de taux ou de moyenne dans la littérature. En
<a href="https://github.com/epiverse-trace/epichains" class="external-link">epichains</a> cela peut ressembler à ceci :</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>  offspring_dist <span class="ot">=</span> rpois,</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  lambda <span class="ot">=</span> mers_offspring[<span class="st">"mean"</span>],</span></code></pre>
</div>
<p>Dans cet exemple, nous pouvons spécifier
<code>lambda = mers_offspring["mean"]</code> car le nombre moyen de cas
secondaires générés (c’est-à-dire <span class="math inline">\(R\)</span>) devrait être le même quelle que soit
la distribution que nous supposons. Ce qui change, c’est la variance de
la distribution, et donc le niveau de variation de la transmission au
niveau individuel. Lorsque le paramètre de dispersion <span class="math inline">\(k\)</span> s’approche l’infini (<span class="math inline">\(k \rightarrow \infty\)</span>) dans une
distribution binomiale négative, la variance est égale à la moyenne.
Cela fait de la distribution de Poisson classique un cas particulier de
la distribution binomiale négative.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="obtenir-le-temps-de-génération">Obtenir le temps de génération<a class="anchor" aria-label="anchor" href="#obtenir-le-temps-de-g%C3%A9n%C3%A9ration"></a></h2>
<hr class="half-width"><p>La distribution de <a href="reference.html#serialinterval">l’intervalle de série</a> est
souvent utilisée pour approximer la distribution du temps de génération.
Cette approximation est couramment utilisée parce qu’il est plus facile
d’observer et de mesurer l’apparition des symptômes dans chaque cas que
le moment précis de l’infection.</p>
<div id="accordionSpoiler2" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler2" aria-expanded="false" aria-controls="collapseSpoiler2">
  <h3 class="accordion-header" id="headingSpoiler2">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> temps de génération vs intervalle sériel </h3>
</button>
<div id="collapseSpoiler2" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler2" aria-labelledby="headingSpoiler2">
<div class="accordion-body">
<figure><img src="../fig/serial-interval-observed.jpeg" alt="Schéma de la relation entre les différentes périodes de transmission entre un infecteur et un infecté dans une paire de transmission. La fenêtre d’exposition est définie comme l’intervalle de temps au cours duquel se produit l’exposition virale, et la fenêtre de transmission est définie comme l’intervalle de temps pour la transmission ultérieure par rapport à la durée de l’infection (Chung Lau et al., 2021)." class="figure mx-auto d-block"><div class="figcaption">Schéma de la relation entre les différentes
périodes de transmission entre un infecteur et un infecté dans une paire
de transmission. La fenêtre d’exposition est définie comme l’intervalle
de temps au cours duquel se produit l’exposition virale, et la fenêtre
de transmission est définie comme l’intervalle de temps pour la
transmission ultérieure par rapport à la durée de l’infection (<a href="https://academic.oup.com/jid/article/224/10/1664/6356465" class="external-link">Chung
Lau et al., 2021</a>).</div>
</figure><p>Cependant, l’utilisation de l’option <em>intervalle de série</em>
comme approximation du <em>temps de génération</em> est principalement
valable pour les maladies dans lesquelles l’infectiosité commence après
l’apparition des symptômes (<a href="https://academic.oup.com/jid/article/224/10/1664/6356465" class="external-link">Chung
Lau et al., 2021</a>). Dans les cas où l’infectiosité commence avant
l’apparition des symptômes, les intervalles sériels peuvent avoir des
valeurs négatives, ce qui est le cas pour les maladies à transmission
pré-symptomatique (<a href="https://www.ijidonline.com/article/S1201-9712(20)30119-3/fulltext#gr2" class="external-link">Nishiura
et al., 2020</a>).</p>
</div>
</div>
</div>
</div>
<p>Utilisons le package <a href="https://github.com/epiverse-trace/epiparameter/" class="external-link">epiparameter</a> pour accéder à
l’intervalle de série disponible pour la maladie MERS :</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">serial_interval</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epiparameter_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"mers"</span>,</span>
<span>  epi_name <span class="op">=</span> <span class="st">"serial"</span>,</span>
<span>  single_epiparameter <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">serial_interval</span>, day_range <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">25</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/superspreading-simulate-rendered-unnamed-chunk-4-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>L’intervalle de série pour le MERS a une moyenne de 12.6 jours et un
écart-type de 2.8 jours.</p>
<div id="temps-de-génération-pour-epichains" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="temps-de-génération-pour-epichains" class="callout-inner">
<h3 class="callout-title">temps de génération pour epichains</h3>
<div class="callout-content">
<p>Dans chaque étape de la simulation, <a href="https://github.com/epiverse-trace/epichains" class="external-link">epichains</a> tire des
valeurs du temps de génération pour chaque nouvelle infection génèré de
la distribution de la descendance. Pour les objets de la classe
<epiparameter>, on peut utiliser la fonction de distribution
<code>epiparameter::generate()</code> pour cette entrée.:</epiparameter></p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># In step one, the number of new infections is 2, then:</span></span>
<span><span class="co"># generate 2 random values given the serial interval distribution</span></span>
<span><span class="fu">generate</span><span class="op">(</span>x <span class="op">=</span> <span class="va">serial_interval</span>, times <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SORTIE<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 14.60507 15.06471</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># In step two, the number of new infections is 6, then:</span></span>
<span><span class="co"># generate 6 random values given the serial interval distribution</span></span>
<span><span class="fu">generate</span><span class="op">(</span>x <span class="op">=</span> <span class="va">serial_interval</span>, times <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SORTIE<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 12.522027 16.109812 14.195049  6.875113 15.432142 12.349850</code></pre>
</div>
<p>Étant donné que le valeur de l’entrée pour le champ
<code>times</code> changera à chaque étape, nous devons intégrer
<code>generate()</code> dedans la fonction. <code>epichains</code>
tirera autant de valeurs aléatoires du temps de génération que le nombre
de nouvelles infections à cette étape. Le résultat sera le suivant :</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">generate</span><span class="op">(</span>x <span class="op">=</span> <span class="va">serial_interval</span>, times <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span></code></pre>
</div>
<p>Cette interface est similaire à celle que <a href="https://github.com/epiverse-trace/cfr" class="external-link">cfr</a> utilise
pour établir un lien avec <a href="https://github.com/epiverse-trace/epiparameter/" class="external-link">epiparameter</a>. Lisez le vignette
<a href="https://epiverse-trace.github.io/cfr/articles/delay_distributions.html" class="external-link">travailler
avec des distributions de retard</a> pour plus de détails.</p>
</div>
</div>
</div>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Remarque de l'instructeur </h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" data-bs-parent="#accordionInstructor1" aria-labelledby="headingInstructor1">
<div class="accordion-body">
<p>La fonction permettant de générer un nombre aléatoire à partir d’un
objet de classe <code>&lt;epiparameter&gt;</code> peut également
accepter cette notation :</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">as.function</span><span class="op">(</span>x <span class="op">=</span> <span class="va">serial_interval</span>, func_type <span class="op">=</span> <span class="st">"generate"</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="simuler-une-chaîne-unique">Simuler une chaîne unique<a class="anchor" aria-label="anchor" href="#simuler-une-cha%C3%AEne-unique"></a></h2>
<hr class="half-width"><p>Nous sommes maintenant prêts à utiliser la fonction
<code>simulate_chains()</code> de <a href="https://github.com/epiverse-trace/epichains" class="external-link">epichains</a> pour créer
<strong>un</strong> chaîne de transmission :</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">epichains</span><span class="fu">::</span><span class="fu">simulate_chains</span><span class="op">(</span></span>
<span>  n_chains <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  statistic <span class="op">=</span> <span class="st">"size"</span>,</span>
<span>  offspring_dist <span class="op">=</span> <span class="va">rnbinom</span>,</span>
<span>  mu <span class="op">=</span> <span class="va">mers_offspring</span><span class="op">[</span><span class="st">"mean"</span><span class="op">]</span>,</span>
<span>  size <span class="op">=</span> <span class="va">mers_offspring</span><span class="op">[</span><span class="st">"dispersion"</span><span class="op">]</span>,</span>
<span>  generation_time <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">generate</span><span class="op">(</span>x <span class="op">=</span> <span class="va">serial_interval</span>, times <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<p><code>simulate_chains()</code> nécessite au minimum trois séries
d’arguments :</p>
<ul><li>
<strong>les contrôles de simulation</strong> (<code>n_chains</code>
et <code>statistic</code>),</li>
<li>
<strong>la distribution des descendants</strong>
(<code>offspring_dist</code> et les paramètres de distributions requis),
et</li>
<li>le temps de génération (<code>generation_time</code>).</li>
</ul><p>Dans les lignes ci-dessus, nous avons décrit comment spécifier la
distribution des descendants et le temps de génération. Les
<strong>contrôles la simulation</strong> comprend au moins deux
arguments :</p>
<ul><li>
<code>n_chains</code>, qui définit le nombre de chaînes de
transmission à simuler pour et</li>
<li>
<code>statistic</code> qui définit une statistique de chaîne à
suivre (soit <code>"size"</code> ou <code>"length"</code>) comme critère
d’arrêt pour chaque chaîne simulée.</li>
</ul><div id="critères-darrêt" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="critères-darrêt" class="callout-inner">
<h3 class="callout-title">Critères d’arrêt</h3>
<div class="callout-content">
<p>Il s’agit d’une fonction personnalisable de <a href="https://github.com/epiverse-trace/epichains" class="external-link">epichains</a>.
Par défaut, les simulations de processus de ramification se terminent
lorsqu’elles se sont éteintes. Pour les chaînes de transmission de
longue durée, en <code>simulate_chains()</code> vous pouvez ajouter
l’argument <code>stat_threshold</code></p>
<p>Par exemple, si on définit un critère d’arrêt pour
<code>statistic = "size"</code> de <code>stat_threshold = 500</code> il
n’y aura plus de descendance après une chaîne de taille 500.</p>
</div>
</div>
</div>
<p>La sortie de <code>simulate_chains()</code> crée un objet de classe
<code>&lt;epichains&gt;</code> que nous pouvons ensuite analyser dans
R.</p>
</section><section><h2 class="section-heading" id="simuler-plusieurs-chaînes">Simuler plusieurs chaînes<a class="anchor" aria-label="anchor" href="#simuler-plusieurs-cha%C3%AEnes"></a></h2>
<hr class="half-width"><p>Nous pouvons utiliser <code>simulate_chains()</code> pour créer
plusieurs chaînes et augmenter la probabilité de simuler des projections
de épidémies incontrôlées en cas de distribution de la descendance trop
dispersée.</p>
<p>Nous devons spécifier un élément supplémentaire :</p>
<ul><li>
<code>set.seed(&lt;integer&gt;)</code>, qui est une fonction de
générateur de nombres aléatoires avec une valeur de semence spécifiée,
le nombre <code>&lt;integer&gt;</code> afin de garantir des résultats
cohérents entre les différentes exécutions de code.</li>
</ul><p>Avec cette configuration, chaque <strong>chaîne</strong> représentera
<strong>un cas initial</strong>. Les cas de chaque chaîne sont
indépendants, isolés et sans interactions. Cela signifie que chaque
chaîne disposera de son propre pool de susceptibles, que tu peux
configurer à l’aide de l’option <code>pop</code> ou
<code>percent_immune</code>.</p>
<p>Maintenant, simulons <strong>100</strong> chaînes de transmission
:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run all this chunk together to let set.seed() work!</span></span>
<span><span class="co"># Set seed for random number generator</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">33</span><span class="op">)</span></span>
<span><span class="va">multiple_epichains</span> <span class="op">&lt;-</span> <span class="fu">epichains</span><span class="fu">::</span><span class="fu">simulate_chains</span><span class="op">(</span></span>
<span>  n_chains <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  statistic <span class="op">=</span> <span class="st">"size"</span>,</span>
<span>  offspring_dist <span class="op">=</span> <span class="va">rnbinom</span>,</span>
<span>  mu <span class="op">=</span> <span class="va">mers_offspring</span><span class="op">[</span><span class="st">"mean"</span><span class="op">]</span>,</span>
<span>  size <span class="op">=</span> <span class="va">mers_offspring</span><span class="op">[</span><span class="st">"dispersion"</span><span class="op">]</span>,</span>
<span>  generation_time <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">generate</span><span class="op">(</span>x <span class="op">=</span> <span class="va">serial_interval</span>, times <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<p>Tu peux inspecter le <strong>taille</strong> total de chaque chaîne
simulée, ce qui équivaut au nombre cumulé de cas par chaîne, à l’aide de
la fonction <code>summary()</code> à l’objet de classe
<code>&lt;epichains&gt;</code>:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">multiple_epichains</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SORTIE<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`epichains_summary` object

  [1]   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
 [19]   7   1   1   1   1   1   1   1   1   1   1  14   1   2   1   1   2   1
 [37]   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
 [55]   1   1   1   1 512   1   1   1   1   1 104   1   1   1   1   1   1   1
 [73]   1   1   1   1   1   1   1   1   1   4   1   1   1   1   1   1   1   1
 [91]   1   1   1   1   1   1   1   1   1   1

 Simulated sizes:

Max: 512
Min: 1</code></pre>
</div>
<p>Nous pouvons compter visuellement le nombre de chaînes qui atteignent
plus de 100 cas d’infection, ainsi que les nombres maximum et
minimum.</p>
<div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Défi</h3>
<div class="callout-content">
<p>Utilise la dernière exécution de
<code>epichains::simulate_chains()</code> pour simuler plusieurs
chaînes. Modifie le <code>statistic</code> de <code>"size"</code> à
<code>"length"</code>. Exécute le fonction <code>summary()</code>.</p>
<ul><li>Pour quelle chaîne cette sortie compte-t-elle ?</li>
</ul></div>
</div>
</div>
<div id="accordionHint1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint1" aria-expanded="false" aria-controls="collapseHint1">
  <h4 class="accordion-header" id="headingHint1"> Donner un indice </h4>
</button>
<div id="collapseHint1" class="accordion-collapse collapse" data-bs-parent="#accordionHint1" aria-labelledby="headingHint1">
<div class="accordion-body">
<p>Si tu as besoin d’aide, reviens à la boîte “Taille et longueur de la
chaîne” depuis le début.</p>
</div>
</div>
</div>
</div>
<div id="lire-la-sortie-dépichains" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="lire-la-sortie-dépichains" class="callout-inner">
<h3 class="callout-title">Lire la sortie d’épichains</h3>
<div class="callout-content">
<p>Pour explorer le format de sortie de l’objet multiple_epichains du
classe <code>&lt;epichains&gt;</code>, examinons la simulation
<code>chain</code> nombre 30.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> L’objet épichains </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>Utilisons <code>dplyr::filter()</code> pour cela :</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chain_to_observe</span> <span class="op">&lt;-</span> <span class="fl">30</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#### get epichain summary ----------------------------------------------------</span></span>
<span></span>
<span><span class="va">multiple_epichains</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">filter</span><span class="op">(</span><span class="va">chain</span> <span class="op">==</span> <span class="va">chain_to_observe</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SORTIE<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`&lt;epichains&gt;` object

&lt; epichains head (from first known infector) &gt;

  chain infector infectee generation      time
2    30        1        2          2 14.100967
3    30        1        3          2 10.640301
4    30        1        4          2 15.608764
5    30        1        5          2 13.515424
6    30        1        6          2  9.967474
7    30        1        7          2  9.376222


Number of chains: 100
Number of infectors (known): 3
Number of generations: 3
Use `as.data.frame(&lt;object_name&gt;)` to view the full output in the console.</code></pre>
</div>
<p>Cette sortie contient deux parties :</p>
<ul><li>Un <code>head()</code> des paires infecteur-infecté <strong>en
commençant par le premier infecteur connu</strong>.</li>
<li>Un pied de page récapitulatif, le morceau de texte qui apparaît en
bas :</li>
</ul><div class="codewrapper">
<h3 class="code-label">SORTIE<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Number of infectors (known): 3
Number of generations: 3</code></pre>
</div>
<p>Le <code>chain</code> nombre 30 simulé comporte trois infecteurs
connus et trois générations. Ces nombres sont plus visibles lorsque l’on
imprime les objets <code>&lt;epichains&gt;</code> sous la forme d’un
cadre de données (ou <code>&lt;tibble&gt;</code>).</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Le cadre de données epichains </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#### infector-infectee data frame --------------------------------------------</span></span>
<span></span>
<span><span class="va">multiple_epichains</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">filter</span><span class="op">(</span><span class="va">chain</span> <span class="op">==</span> <span class="va">chain_to_observe</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SORTIE<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 14 × 5
   chain infector infectee generation  time
   &lt;int&gt;    &lt;dbl&gt;    &lt;dbl&gt;      &lt;int&gt; &lt;dbl&gt;
 1    30       NA        1          1  0
 2    30        1        2          2 14.1
 3    30        1        3          2 10.6
 4    30        1        4          2 15.6
 5    30        1        5          2 13.5
 6    30        1        6          2  9.97
 7    30        1        7          2  9.38
 8    30        1        8          2 11.5
 9    30        4        9          3 31.0
10    30        4       10          3 25.3
11    30        4       11          3 28.5
12    30        4       12          3 29.6
13    30        4       13          3 25.9
14    30        4       14          3 24.6 </code></pre>
</div>
<p>Chaîne 30 nous raconte une <strong>histoire</strong>:</p>
<p>“Dans la première génération de transmission à <code>time = 0</code>,
un sujet (<code>ID = NA</code>) a infecté le sujet avec
<code>ID = 1</code>. Sujet <code>ID = 1</code> est le premier infecteur
connu.</p>
<p>“Ensuite, dans la deuxième génération de transmission, le sujet
<code>ID = 1</code> a infecté sept sujets, de <code>ID = 2</code> à
<code>ID = 8</code>. Ces infections se sont produites chez
<code>time</code> entre le 9e et le 15e jour, après la première
infection connue.</p>
<p>“Plus tard, lors de la troisième génération de transmission, le sujet
<code>ID = 4</code> a infecté six nouveaux sujets, de
<code>ID = 9</code> à <code>ID = 14</code>. Ces infections se sont
produites chez <code>time</code> entre le 24e et le 31e jour, après la
première infection connue.”</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Un cadre de données sur les personnes infectées </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<p>Le cadre de données de sortie recueille <strong>les infectés</strong>
comme unité d’observation :</p>
<ul><li>Chaque personne infectée a un <code>infectee</code> “ID”.</li>
<li>Chaque <em>infecté</em> qui se comporte comme un <em>infecteur</em>
est enregistré dans la base de données <code>infector</code> colonne à
l’aide de <code>infectee</code> “id”.</li>
<li>Chaque personne infectée l’a été à un moment précis.
<code>generation</code> et <code>time</code> (continu).</li>
<li>Le numéro de simulation est enregistré sous le <code>chain</code>
colonne.</li>
</ul><p><strong>Remarque :</strong> Le
<code>Number of infectors (known)</code> comprend le sujet
<code>ID = NA</code> sous le <code>infector</code> colonne. Il s’agit de
l’infecteur spécifié comme cas d’index (dans la colonne
<code>n_chains</code> ), qui a commencé la chaîne de transmission à
l’infecté de <code>ID = 1</code> à <code>generation = 1</code> et
<code>time = 0</code>.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="répéter-les-simulations">Répéter les simulations<a class="anchor" aria-label="anchor" href="#r%C3%A9p%C3%A9ter-les-simulations"></a></h2>
<hr class="half-width"><p>Comme précédemment, nous pouvons configurer la simulation de
plusieurs chaînes en augmentant simplement le nombre de chaînes (par ex.
<code>n_chains = 1</code> à <code>n_chains = 100</code>). Cependant, si
nous devons supposer que chaque cas initial commence (à être infectieux)
à un moment différent, cela ne peut être configuré que dans une seule
fonction de simulation. Il faut donc <strong>itérer</strong> plusieurs
fois sur une configuration spécifique de simulation de chaîne pour
augmenter la probabilité de simuler des projections d’épidémies
incontrôlées. Le tableau suivant compare les alternatives :</p>
<table class="table"><colgroup><col width="25%"><col width="25%"><col width="25%"><col width="25%"></colgroup><thead><tr class="header"><th>Simulations</th>
<th>Cas initiaux</th>
<th>Heure de début (<code>t0</code>)</th>
<th>Utilise</th>
</tr></thead><tbody><tr class="odd"><td>Un</td>
<td>1</td>
<td>Idem</td>
<td>
<code>epichains::simulate_chains()</code> avec
<code>n_chains = 1</code>
</td>
</tr><tr class="even"><td>Multiple (100, par exemple)</td>
<td>1</td>
<td>Idem</td>
<td>
<code>epichains::simulate_chains()</code> avec
<code>n_chains = 100</code>
</td>
</tr><tr class="odd"><td>Multiple (100, par exemple)</td>
<td>Plus d’un</td>
<td>Différents</td>
<td>Itère 100 fois en utilisant <code>purrr::map()</code> sur
<code>epichains::simulate()</code>
</td>
</tr></tbody></table><p>La différence essentielle de la troisième configuration est
l’argument <code>t0</code> de <code>epichains::simulate_chains()</code>.
L’argument <code>t0</code> définit l’heure de début de chaque cas
initial par chaîne.</p>
<div id="callout4" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">À noter</h3>
<div class="callout-content">
<p>Un exemple d’utilisation de l’itération est disponible dans la
vignette <a href="https://github.com/epiverse-trace/epichains" class="external-link">epichains</a> sur <a href="https://epiverse-trace.github.io/epichains/articles/projecting_incidence.html" class="external-link">Prévision
de l’incidence des maladies infectieuses : un exemple de COVID-19</a>.
Il s’agit de simuler l’importation de 13 cas à différents moments.</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">epichains</span><span class="fu">::</span><span class="va">covid19_sa</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">mutate</span><span class="op">(</span>start_time <span class="op">=</span> <span class="va">date</span> <span class="op">-</span> <span class="fu">min</span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SORTIE<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 5 × 3
  date       cases start_time
  &lt;date&gt;     &lt;int&gt; &lt;drtn&gt;
1 2020-03-05     1 0 days
2 2020-03-07     1 2 days
3 2020-03-08     1 3 days
4 2020-03-09     4 4 days
5 2020-03-11     6 6 days    </code></pre>
</div>
<p>Au lieu d’avoir 100 chaînes commençant au même jour 0
(<code>t0 = 0</code>, par défaut), chaque simulation créera des chaînes
qui commenceront à un moment différent dans le temps. Elle considérera
le jour <code>2020-03-05</code> comme Jour <code>0</code>. La première
chaîne commence au jour 0, une au jour 2, une au jour 3, quatre au jour
4 et six au jour 6. L’argument <code>t0</code> aura cette structure
:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t0</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fu">rep</span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu">rep</span><span class="op">(</span><span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">t0</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SORTIE<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1] 0 2 3 4 4 4 4 6 6 6 6 6 6</code></pre>
</div>
<p>Pour augmenter la probabilité de simuler des projections d’épidémies
incontrôlées, ce même scénario doit être itéré 100 fois. Cela nous
aidera à fournir une projection avec de l’incertitude.</p>
</div>
</div>
</div>
<p>Dans cette section, nous allons te montrer comment construire le
<strong>itération</strong> sur <a href="https://github.com/epiverse-trace/epichains" class="external-link">epichains</a> étape par étape.
Nous répliquerons la même simulation que précédemment : 100 chaînes de
transmission avec 1 cas initial chacune à partir du jour 0
(<code>t0 = 0</code>). Mais au lieu d’utiliser
<code>n_chains = 100</code> nous allons itérer 100 fois sur la
simulation d’une chaîne de transmission avec un cas initial à partir du
jour 0 (<code>n_chains = 1</code>).</p>
<p>Nous devons spécifier deux éléments supplémentaires :</p>
<ul><li>
<code>number_simulations</code>, qui définit le nombre de
simulations à effectuer.</li>
<li>
<code>initial_cases</code> définit le nombre de cas initiaux à
introduire dans l’argument <code>n_chains</code> expliqué dans les
lignes ci-dessus.</li>
</ul><div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Number of simulation runs</span></span>
<span><span class="va">number_simulations</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="co"># Number of initial cases</span></span>
<span><span class="va">initial_cases</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></code></pre>
</div>
<p><code>number_simulations</code> et <code>initial_cases</code> sont
commodément stockés dans des objets pour faciliter leur réutilisation en
aval dans le flux de travail.</p>
<div id="itération-à-laide-de-purrr" class="callout checklist">
<div class="callout-square">
<i class="callout-icon" data-feather="check-square"></i>
</div>
<div id="itération-à-laide-de-purrr" class="callout-inner">
<h3 class="callout-title">Itération à l’aide de purrr</h3>
<div class="callout-content">
<p><a href="https://r4ds.hadley.nz/iteration.html" class="external-link">Itération</a> vise à
effectuer la même action sur différents objets de manière répétée.</p>
<p>Apprenez à utiliser les fonctions de base de <a href="https://purrr.tidyverse.org/" class="external-link">purrr</a>
comme <code>map()</code> à partir du tutoriel YouTube sur <a href="https://www.youtube.com/watch?v=nd-Y8b22YaQ" class="external-link">How to purrr</a> par
Equitable Equations.</p>
<p>Ou, si vous avez déjà utilisé la famille de
fonctions<code>*apply</code>, visitez la vignette du package <a href="https://purrr.tidyverse.org/articles/base.html" class="external-link">purrr base R</a>
qui présente les principales différences, des traductions directes et
des exemples.</p>
</div>
</div>
</div>
<p>Pour obtenir plusieurs chaînes, nous devons appliquer la méthode
<code>simulate_chains()</code> à chaque chaîne définie par une séquence
de nombres allant de 1 à 100.</p>
<div id="purrr-et-epichains" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="purrr-et-epichains" class="callout-inner">
<h3 class="callout-title">purrr et epichains</h3>
<div class="callout-content">
<p>Tout d’abord, décrivons comment nous utilisons
<code>purrr::map()</code> avec
<code>epichains::simulate_chains()</code>. La fonction
<code>map()</code> nécessite deux arguments :</p>
<ul><li>
<code>.x</code>, un vecteur de nombres, et</li>
<li>
<code>.f</code> une fonction permettant d’itérer sur chaque valeur
du vecteur.</li>
</ul><div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># steps:</span></span>
<span><span class="co"># - purrr::map() will run 100 times function(sim).</span></span>
<span><span class="co"># - seq_len() creates a vector with sequence of numbers (simulation IDs from 1 to 100) and</span></span>
<span><span class="co"># - function(sim) iterates {epichains} to each simulation ID number, then</span></span>
<span><span class="co"># - dplyr::mutate() adds a column to the &lt;epichains&gt; output with the simulation ID number.</span></span>
<span><span class="co"># - purrr::list_rbind() combines all the list class outputs (for each simulation ID) into a single data frame.</span></span>
<span><span class="fu">purrr</span><span class="fu">::</span><span class="fu">map</span><span class="op">(</span></span>
<span>  .x <span class="op">=</span> <span class="fu">seq_len</span><span class="op">(</span><span class="va">number_simulations</span><span class="op">)</span>,</span>
<span>  .f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">sim</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">epichains</span><span class="fu">::</span><span class="fu">simulate_chains</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># &lt;-- {epichains}</span></span>
<span>      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">mutate</span><span class="op">(</span>simulation_id <span class="op">=</span> <span class="va">sim</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu">list_rbind</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># pseudo code: do not run.</span></span></code></pre>
</div>
<p>L’élément <code>sim</code> est placé pour enregistrer le numéro
d’itération (<strong>ID de simulation</strong>) dans une nouvelle
colonne dans la sortie <code>&lt;epichains&gt;</code>. La fonction
<code>purrr::list_rbind()</code> a pour but de combiner toutes les
sorties de liste de <code>map()</code>.</p>
<p><strong>Pourquoi un point (<code>.</code>) comme préfixe ?</strong>
Dans le <a href="https://design.tidyverse.org/dots-prefix.html" class="external-link">principes de
conception ordonnée</a> nous avons un chapitre sur le préfixe point
!</p>
</div>
</div>
</div>
<p>Nous sommes maintenant prêts à utiliser <code>purrr::map()</code>
pour simuler de manière répétée de <code>simulate_chains()</code> et de
stocker dans un vecteur de 1 à 100:</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">33</span><span class="op">)</span></span>
<span><span class="va">simulated_chains_map</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu">map</span><span class="op">(</span></span>
<span>    .x <span class="op">=</span> <span class="fu">seq_len</span><span class="op">(</span><span class="va">number_simulations</span><span class="op">)</span>,</span>
<span>    .f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">sim</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu">epichains</span><span class="fu">::</span><span class="fu">simulate_chains</span><span class="op">(</span></span>
<span>        n_chains <span class="op">=</span> <span class="va">initial_cases</span>,</span>
<span>        statistic <span class="op">=</span> <span class="st">"size"</span>,</span>
<span>        offspring_dist <span class="op">=</span> <span class="va">rnbinom</span>,</span>
<span>        mu <span class="op">=</span> <span class="va">mers_offspring</span><span class="op">[</span><span class="st">"mean"</span><span class="op">]</span>,</span>
<span>        size <span class="op">=</span> <span class="va">mers_offspring</span><span class="op">[</span><span class="st">"dispersion"</span><span class="op">]</span>,</span>
<span>        generation_time <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">generate</span><span class="op">(</span>x <span class="op">=</span> <span class="va">serial_interval</span>, times <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span>      <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">mutate</span><span class="op">(</span>simulation_id <span class="op">=</span> <span class="va">sim</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu">list_rbind</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>Une limitation de la sortie itérative est que nous ne pouvons pas
utiliser la fonction summary(<epichains>) pour résumer la sortie.</epichains></p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simulated_chains_map</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">count</span><span class="op">(</span><span class="va">simulation_id</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">pull</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SORTIE<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  [1]   1   1   1   1   1   1   1   1   1   1   1   1   1   1   9   1   1   1
 [19]   1   1   1   1 113   1   1   1   1   1   1   1   1   1  19   1   1   1
 [37]   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
 [55]   1   1   1   1   1   1   1   1   1   1   1   1   1   1  22   1   1   1
 [73]   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
 [91]   1   1   1   1   1   1   1   1   1   1</code></pre>
</div>
</section><section><h2 class="section-heading" id="visualiser-plusieurs-chaînes">Visualiser plusieurs chaînes<a class="anchor" aria-label="anchor" href="#visualiser-plusieurs-cha%C3%AEnes"></a></h2>
<hr class="half-width"><p>Pour augmenter la probabilité de simuler des projections d’épidémies
incontrôlées compte tenu d’une distribution surdispersée de la
progéniture, simulons <strong>1000 chaînes de transmission</strong> avec
1 cas initial pour chacune d’entre elles, à partir du jour 0.</p>
<p>Nous allons créer une simulation multiple <strong>sans</strong>
itération pour cette section :</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">33</span><span class="op">)</span></span>
<span><span class="va">multiple_epichains</span> <span class="op">&lt;-</span> <span class="fu">epichains</span><span class="fu">::</span><span class="fu">simulate_chains</span><span class="op">(</span></span>
<span>  n_chains <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  statistic <span class="op">=</span> <span class="st">"size"</span>,</span>
<span>  offspring_dist <span class="op">=</span> <span class="va">rnbinom</span>,</span>
<span>  mu <span class="op">=</span> <span class="va">mers_offspring</span><span class="op">[</span><span class="st">"mean"</span><span class="op">]</span>,</span>
<span>  size <span class="op">=</span> <span class="va">mers_offspring</span><span class="op">[</span><span class="st">"dispersion"</span><span class="op">]</span>,</span>
<span>  generation_time <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">generate</span><span class="op">(</span>x <span class="op">=</span> <span class="va">serial_interval</span>, times <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<p>Pour visualiser les chaînes simulées, nous avons besoin d’un
traitement préalable :</p>
<ol style="list-style-type: decimal"><li>Utilisons <a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a> pour obtenir des nombres de temps
ronds qui ressemblent à des journées de surveillance.</li>
<li>Compte les cas quotidiens dans chaque simulation (par
<code>chain</code>).</li>
<li>Calcule le nombre cumulé de cas dans une simulation.</li>
</ol><div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># daily aggregate of cases</span></span>
<span><span class="va">aggregate_chains</span> <span class="op">&lt;-</span> <span class="va">multiple_epichains</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># use data.frame output from &lt;epichains&gt; object</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># get the round number (day) of infection times</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">mutate</span><span class="op">(</span>day <span class="op">=</span> <span class="fu">ceiling</span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># count the daily number of cases in each chain</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">count</span><span class="op">(</span><span class="va">chain</span>, <span class="va">day</span>, name <span class="op">=</span> <span class="st">"cases"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># calculate the cumulative number of cases for each chain</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">group_by</span><span class="op">(</span><span class="va">chain</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">mutate</span><span class="op">(</span>cases_cumsum <span class="op">=</span> <span class="fu">cumsum</span><span class="op">(</span><span class="va">cases</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>Avant le graphique, créons un tableau de sommaire avec la durée
totale et la taille de chaque chaîne. Nous pouvons utiliser la “combo”
<a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a> de <code>group_by()</code>,
<code>summarise()</code> et <code>ungroup()</code>:</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Summarise the chain duration and size</span></span>
<span><span class="va">summary_chains</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">aggregate_chains</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">group_by</span><span class="op">(</span><span class="va">chain</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">summarise</span><span class="op">(</span></span>
<span>    <span class="co"># duration</span></span>
<span>    day_max <span class="op">=</span> <span class="fu">max</span><span class="op">(</span><span class="va">day</span><span class="op">)</span>,</span>
<span>    <span class="co"># size</span></span>
<span>    cases_total <span class="op">=</span> <span class="fu">max</span><span class="op">(</span><span class="va">cases_cumsum</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">summary_chains</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SORTIE<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1,000 × 3
   chain day_max cases_total
   &lt;int&gt;   &lt;dbl&gt;       &lt;int&gt;
 1     1       0           1
 2     2       0           1
 3     3       0           1
 4     4       0           1
 5     5       0           1
 6     6       0           1
 7     7       0           1
 8     8       0           1
 9     9       0           1
10    10       0           1
# ℹ 990 more rows</code></pre>
</div>
<p>Maintenant, nous sommes prêts à utiliser le package
<a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a> :</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Visualize transmission chains by cumulative cases</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># create grouped chain trajectories</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">aggregate_chains</span>,</span>
<span>    mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">day</span>,</span>
<span>      y <span class="op">=</span> <span class="va">cases_cumsum</span>,</span>
<span>      group <span class="op">=</span> <span class="va">chain</span></span>
<span>    <span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>    show.legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># define a 100-case threshold</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Day"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Cumulative cases"</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/superspreading-simulate-rendered-unnamed-chunk-21-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Bien que la plupart des présentations de 1 ne génèrent pas de cas
secondaires (N = 934) ou que la plupart des épidémies s’éteignent
rapidement (durée médiane de 17 et taille médiane de 5.5), seulement 1
trajectoires épidémiques parmi les 100 simulations (1%) peuvent
atteindre plus de 100 cas infectés. Ce résultat est remarquable carle
nombre de reproduction <span class="math inline">\(R\)</span> est
inférieur à 1 (moyenne de la distribution des descendants de 0.6), mais,
compte tenu d’un paramètre de dispersion de la distribution de la
progéniture de 0.02 il montre le potentiel de épidémies explosives de la
maladie MERS.</p>
<p>Nous pouvons compter combien de chaînes ont atteint le seuil de 100
cas en utilisant les fonctions<a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a>. Cette sortie devrait
nous donner des résultats équivalents à
summary(multiple_epichains)`:</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># number of chains that reached the 100-case threshold</span></span>
<span><span class="va">summary_chains</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">cases_total</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">filter</span><span class="op">(</span><span class="va">cases_total</span> <span class="op">&gt;</span> <span class="fl">100</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SORTIE<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 × 3
  chain day_max cases_total
  &lt;int&gt;   &lt;dbl&gt;       &lt;int&gt;
1    65      34         103</code></pre>
</div>
<div id="accordionSpoiler3" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler3" aria-expanded="false" aria-controls="collapseSpoiler3">
  <h3 class="accordion-header" id="headingSpoiler3">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Cas observés vs chaînes simulées. </h3>
</button>
<div id="collapseSpoiler3" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler3" aria-labelledby="headingSpoiler3">
<div class="accordion-body">
<p>Recouvrons le nombre cumulé de cas observés à l’aide de l’objet
linelist de l’ensemble de données <code>mers_korea_2015</code> du
package R <a href="https://github.com/reconhub/outbreaks" class="external-link">outbreaks</a>. Pour préparer l’ensemble de données
afin de pouvoir tracer le nombre total de cas quotidiens au fil du
temps, nous utilisons <a href="https://www.reconverse.org/incidence2/" class="external-link">incidence2</a> pour convertir la liste
de lignes en un objet <code>&lt;incidence2&gt;</code>, et compléte les
dates manquantes de la série temporelle à l’aide de
<code>complete_dates()</code></p>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">outbreaks</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mers_cumcases</span> <span class="op">&lt;-</span> <span class="va">mers_korea_2015</span><span class="op">$</span><span class="va">linelist</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># incidence2 workflow</span></span>
<span>  <span class="fu">incidence2</span><span class="fu">::</span><span class="fu">incidence</span><span class="op">(</span>date_index <span class="op">=</span> <span class="st">"dt_onset"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">incidence2</span><span class="fu">::</span><span class="fu">complete_dates</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># wrangling using {dplyr}</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">mutate</span><span class="op">(</span>count_cumsum <span class="op">=</span> <span class="fu">cumsum</span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu">rownames_to_column</span><span class="op">(</span>var <span class="op">=</span> <span class="st">"day"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">mutate</span><span class="op">(</span>day <span class="op">=</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">day</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>Utilise <code>plot()</code> pour faire un graphique d’incidence :</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot the incidence2 object</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">mers_cumcases</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/superspreading-simulate-rendered-unnamed-chunk-25-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></div>
</div>
</div>
</div>
<p>En traçant le nombre observé de cas cumulés de l’épidémie de syndrome
respiratoire du Moyen-Orient (MERS) en Corée du Sud en 2015 à côté des
chaînes simulées précédemment, on constate que les cas observés ont
suivi une trajectoire conforme à la dynamique de l’épidémie explosive
simulée (ce qui est logique, étant donné que la simulation utilise des
paramètres basés sur cette épidémie spécifique).</p>
<figure><img src="../fig/superspreading-simulate-rendered-unnamed-chunk-26-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Lorsque nous augmentons le paramètre de dispersion de <span class="math inline">\(k = 0.01\)</span> à <span class="math inline">\(k
= \infty\)</span> - et réduisons ainsi la variation de la transmission
au niveau individuel - et supposons un nombre de reproduction fixe <span class="math inline">\(R = 1.5\)</span> La proportion de épidémies
simulés ayant atteint le seuil de 100 cas augmente. Cela s’explique par
le fait que les épidémies simulées ont maintenant une dynamique plus
cohérente, dans le sens des aiguilles d’une montre, plutôt que le niveau
élevé de variabilité observé précédemment.</p>
<figure><img src="../fig/see-nature04153_Fig2-c.jpg" alt="Croissance des épidémies avec R = 1,5 et un cas initial, conditionné à la non-extinction. Les cadres indiquent la médiane et l’écart interquartile (EQI) de la première génération de maladie avec 100 cas ; les moustaches indiquent les valeurs les plus extrêmes dans un rayon de 1,5 × EQI des cadres, et les croix indiquent les valeurs aberrantes. Les pourcentages indiquent la proportion de 10 000 foyers simulés qui ont atteint le seuil de 100 cas (Lloyd-Smith et al., 2005)." class="figure mx-auto d-block"><div class="figcaption">
<strong>Croissance des épidémies avec R = 1,5 et
un cas initial, conditionné à la non-extinction.</strong> Les cadres
indiquent la médiane et l’écart interquartile (EQI) de la première
génération de maladie avec 100 cas ; les moustaches indiquent les
valeurs les plus extrêmes dans un rayon de 1,5 × EQI des cadres, et les
croix indiquent les valeurs aberrantes. Les pourcentages indiquent la
proportion de 10 000 foyers simulés qui ont atteint le seuil de 100 cas
(<a href="https://www.nature.com/articles/nature04153" class="external-link">Lloyd-Smith et
al., 2005</a>).</div>
</figure><div id="les-premières-projections-de-propagation" class="callout testimonial">
<div class="callout-square">
<i class="callout-icon" data-feather="heart"></i>
</div>
<div id="les-premières-projections-de-propagation" class="callout-inner">
<h3 class="callout-title">Les premières projections de propagation</h3>
<div class="callout-content">
<p>Dans la phase initiale de l’épidémie, tu peux utiliser
<a href="https://github.com/epiverse-trace/epichains" class="external-link">epichains</a> pour appliquer un modèle de processus de
ramification afin de prévoir le nombre de cas futurs. Même si le modèle
tient compte du caractère aléatoire de la transmission et de la
variation du nombre de cas secondaires, il peut y avoir des
caractéristiques locales supplémentaires que nous n’avons pas prises en
compte. L’analyse des premières prévisions faites pour le COVID dans
différents pays à l’aide de cette structure de modèle a révélé que les
prévisions étaient souvent trop confiantes (<a href="https://www.eurosurveillance.org/content/10.2807/1560-7917.ES.2020.25.18.2000543#validationofthemodel-1" class="external-link">Pearson
et al., 2020</a>). Cela est probablement dû au fait que le modèle en
temps réel n’incluait pas tous les changements dans la distribution de
descendance qui se produisaient au niveau local à la suite des
changements de comportement et des mesures de contrôle. Tu peux en
savoir plus sur l’importance du contexte local dans les modèles COVID-19
dans . <a href="https://www.nature.com/articles/s43588-020-00014-7" class="external-link">Eggo
et al. (2020)</a>.</p>
<p>Nous t’invitons à lire la vignette sur <a href="https://epiverse-trace.github.io/epichains/articles/projecting_incidence.html" class="external-link">Prévision
de l’incidence des maladies infectieuses : un exemple de COVID-19</a>!
pour en savoir plus sur l’établissement de prévisions à l’aide de
<a href="https://github.com/epiverse-trace/epichains" class="external-link">epichains</a>.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="défis">Défis<a class="anchor" aria-label="anchor" href="#d%C3%A9fis"></a></h2>
<hr class="half-width"><div id="potentiel-dune-épidémie-importante-de-variole-du-singe" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="potentiel-dune-épidémie-importante-de-variole-du-singe" class="callout-inner">
<h3 class="callout-title">Potentiel d’une épidémie importante de variole du singe</h3>
<div class="callout-content">
<p>Évalue le potentiel d’un nouveau cas de variole du singe (Mpox) à
générer une grande épidémie explosive.</p>
<ul><li>Simule 1000 chaînes de transmission avec 1 cas initial chacune à
partir du jour 0.</li>
<li>Utilise le paquet approprié pour accéder aux données de retard des
épidémies précédentes.</li>
<li>Combien de trajectoires simulées atteignent plus de 100 cas infectés
?</li>
</ul></div>
</div>
</div>
<div id="accordionHint2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint2" aria-expanded="false" aria-controls="collapseHint2">
  <h4 class="accordion-header" id="headingHint2"> Donner un indice </h4>
</button>
<div id="collapseHint2" class="accordion-collapse collapse" data-bs-parent="#accordionHint2" aria-labelledby="headingHint2">
<div class="accordion-body">
<p>Avec <a href="https://github.com/epiverse-trace/epiparameter/" class="external-link">epiparameter</a>, tu peux accéder et utiliser les
distributions des descendants et des retards des épidémies d’Ebola
précédentes.</p>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">epiparameter</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epiparameter_db</span><span class="op">(</span>epi_name <span class="op">=</span> <span class="st">"offspring"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">parameter_tbl</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">count</span><span class="op">(</span><span class="va">disease</span>, <span class="va">epi_name</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SORTIE<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># Parameter table:
# A data frame:    6 × 3
  disease                       epi_name                   n
  &lt;chr&gt;                         &lt;chr&gt;                  &lt;int&gt;
1 Ebola Virus Disease           offspring distribution     1
2 Hantavirus Pulmonary Syndrome offspring distribution     1
3 Mpox                          offspring distribution     1
4 Pneumonic Plague              offspring distribution     1
5 SARS                          offspring distribution     2
6 Smallpox                      offspring distribution     4</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epiparameter_db</span><span class="op">(</span>epi_name <span class="op">=</span> <span class="st">"serial interval"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">parameter_tbl</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">count</span><span class="op">(</span><span class="va">disease</span>, <span class="va">epi_name</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SORTIE<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># Parameter table:
# A data frame:    6 × 3
  disease               epi_name            n
  &lt;chr&gt;                 &lt;chr&gt;           &lt;int&gt;
1 COVID-19              serial interval     4
2 Ebola Virus Disease   serial interval     4
3 Influenza             serial interval     1
4 MERS                  serial interval     2
5 Marburg Virus Disease serial interval     2
6 Mpox                  serial interval     5</code></pre>
</div>
<p>De plus, étant donné que tu n’as besoin que d’une seule chaîne par
itération, commençant le même jour, il n’est peut-être pas nécessaire
d’utiliser l’itération pour celle-ci.</p>
</div>
</div>
</div>
</div>
<div id="accordionInstructor2" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor2" aria-expanded="false" aria-controls="collapseInstructor2">
  <h3 class="accordion-header" id="headingInstructor2">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Remarque de l'instructeur </h3>
</button>
<div id="collapseInstructor2" class="accordion-collapse collapse" data-bs-parent="#accordionInstructor2" aria-labelledby="headingInstructor2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load packages -----------------------------------------------------------</span></span>
<span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">epiparameter</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># delays ------------------------------------------------------------------</span></span>
<span></span>
<span><span class="va">mpox_offspring_epiparam</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epiparameter_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"mpox"</span>,</span>
<span>  epi_name <span class="op">=</span> <span class="st">"offspring"</span>,</span>
<span>  single_epiparameter <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">mpox_offspring</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">get_parameters</span><span class="op">(</span><span class="va">mpox_offspring_epiparam</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mpox_serialint</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epiparameter_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"mpox"</span>,</span>
<span>  epi_name <span class="op">=</span> <span class="st">"serial interval"</span>,</span>
<span>  single_epiparameter <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># iterate -----------------------------------------------------------------</span></span>
<span></span>
<span><span class="co"># Set seed for random number generator</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">33</span><span class="op">)</span></span>
<span></span>
<span><span class="va">simulated_chains_mpox</span> <span class="op">&lt;-</span> <span class="fu">epichains</span><span class="fu">::</span><span class="fu">simulate_chains</span><span class="op">(</span></span>
<span>  n_chains <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  statistic <span class="op">=</span> <span class="st">"size"</span>,</span>
<span>  offspring_dist <span class="op">=</span> <span class="va">rnbinom</span>,</span>
<span>  mu <span class="op">=</span> <span class="va">mpox_offspring</span><span class="op">[</span><span class="st">"mean"</span><span class="op">]</span>,</span>
<span>  size <span class="op">=</span> <span class="va">mpox_offspring</span><span class="op">[</span><span class="st">"dispersion"</span><span class="op">]</span>,</span>
<span>  generation_time <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">generate</span><span class="op">(</span>x <span class="op">=</span> <span class="va">mpox_serialint</span>, times <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># visualize ---------------------------------------------------------------</span></span>
<span></span>
<span><span class="co"># daily aggregate of cases</span></span>
<span><span class="va">simulated_chains_mpox_day</span> <span class="op">&lt;-</span> <span class="va">simulated_chains_mpox</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># use data.frame output from &lt;epichains&gt; object</span></span>
<span>  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># Count the daily number of cases in each chain</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>day <span class="op">=</span> <span class="fu">ceiling</span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">chain</span>, <span class="va">day</span>, name <span class="op">=</span> <span class="st">"cases"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># Calculate the cumulative number of cases for each chain</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">chain</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>cumulative_cases <span class="op">=</span> <span class="fu">cumsum</span><span class="op">(</span><span class="va">cases</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize transmission chains by cumulative cases</span></span>
<span><span class="va">simulated_chains_mpox_day</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># Create grouped chain trajectories</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">day</span>, y <span class="op">=</span> <span class="va">cumulative_cases</span>, group <span class="op">=</span> <span class="va">chain</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.25</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Define a 100-case threshold</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Day"</span>, y <span class="op">=</span> <span class="st">"Cumulative cases"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/superspreading-simulate-rendered-unnamed-chunk-28-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Dans l’hypothèse d’une épidémie de variole du singe avec <span class="math inline">\(R\)</span> = 0.32 et <span class="math inline">\(k\)</span> = 0.58, il n’y a pas de trajectoire
parmi 1000 simulations qui atteignent plus de 100 cas infectés. Par
rapport au MERS (<span class="math inline">\(R\)</span> = 0.6 et <span class="math inline">\(k\)</span> = 0.02).</p>
</div>
</div>
</div>
</div>
<div id="accordionHint3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint3" aria-expanded="false" aria-controls="collapseHint3">
  <h4 class="accordion-header" id="headingHint3"> Évaluation du risque de l’épidémie en tenant compte de la superspreading. </h4>
</button>
<div id="collapseHint3" class="accordion-collapse collapse" data-bs-parent="#accordionHint3" aria-labelledby="headingHint3">
<div class="accordion-body">
<p>Avec <a href="https://github.com/epiverse-trace/superspreading" class="external-link">superspreading</a> tu peux obtenir des solutions
numériques à des processus qui <a href="https://github.com/epiverse-trace/epichains" class="external-link">epichains</a> résoudre à
l’aide de processus de branchement. Nous t’invitons à lire le vignette
<a href="https://github.com/epiverse-trace/superspreading" class="external-link">superspreading</a> sur <a href="https://epiverse-trace.github.io/superspreading/articles/epidemic_risk.html" class="external-link">Le
risque épidémique</a> et répondre à :</p>
<ul><li>Quelle est la probabilité qu’un agent pathogène nouvellement
introduit provoque une grande épidémie ?</li>
<li>Quelle est la probabilité qu’une infection ne s’établisse pas, par
hasard, après une ou plusieurs introductions initiales ?</li>
<li>Quelle est la probabilité que l’épidémie soit contenue ?</li>
</ul><p>Vérifie sices estimations varient de façon non linéaire en fonction
du nombre moyen de reproduction. <span class="math inline">\(R\)</span>
et de la dispersion <span class="math inline">\(k\)</span> d’une maladie
donnée.</p>
<!-- projet de défi -->
<!-- Calcule la probabilité qu'un nouveau cas de Mpox conduise à une grande épidémie en l'absence de mesures de contrôle. Utilise le progiciel approprié pour accéder aux données de délai des épidémies précédentes. -->
</div>
</div>
</div>
</div>
<div id="a-partir-dune-répartition-des-cas-secondaires" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="a-partir-dune-répartition-des-cas-secondaires" class="callout-inner">
<h3 class="callout-title">A partir d’une répartition des cas secondaires</h3>
<div class="callout-content">
<p><a href="https://www.thelancet.com/journals/laninf/article/PIIS1473-3099(15)70135-0/fulltext" class="external-link">Christian
Althaus, 2015</a> a réutiliser des données publiées par <a href="https://www.thelancet.com/journals/laninf/article/PIIS1473-3099(14)71075-8/fulltext#gr2" class="external-link">Faye
et al, 2015 (Figure 2)</a> sur l’arbre de transmission de la maladie à
virus Ebola à Conakry, en Guinée, en 2014.</p>
<p>En utilisant les données sous l’onglet “indice” :</p>
<ul><li>Estime la distribution de la descendance à partir de la distribution
des cas secondaires.</li>
<li>Estime ensuite le potentiel de grande épidémie à partir de ces
données, en effectuant 100 simulations avec un cas initial.</li>
<li>Imprime le résumé de l’objet de classe
<code>&lt;epichains&gt;</code>. Cela devrait nous aider à compter le
nombre de chaînes qui atteignent un <code>size</code> de plus de 100 cas
infectés.</li>
</ul><p>Pour des résultats reproductibles, utilise
<code>set.seed(645)</code>.</p>
</div>
</div>
</div>
<div id="accordionHint4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint4" aria-expanded="false" aria-controls="collapseHint4">
  <h4 class="accordion-header" id="headingHint4"> Donner un indice </h4>
</button>
<div id="collapseHint4" class="accordion-collapse collapse" data-bs-parent="#accordionHint4" aria-labelledby="headingHint4">
<div class="accordion-body">
<p>Code avec les données de l’arbre de transmission écrites par <a href="https://www.thelancet.com/journals/laninf/article/PIIS1473-3099(15)70135-0/fulltext" class="external-link">Christian
Althaus, 2015</a>:</p>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Number of individuals in the trees</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">152</span></span>
<span><span class="co"># Number of secondary cases for all individuals</span></span>
<span><span class="va">c1</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">14</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">8</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>,</span>
<span>        <span class="fl">4</span>, <span class="fl">9</span>, <span class="fl">9</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">17</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">2</span>,</span>
<span>        <span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">9</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">c0</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="va">c1</span>, <span class="fu">rep</span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span> <span class="op">-</span> <span class="fu">length</span><span class="op">(</span><span class="va">c1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">c0</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">enframe</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/superspreading-simulate-rendered-unnamed-chunk-31-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Défi facultatif :</p>
<ul><li>Reproduis la figure (B) de <a href="https://www.thelancet.com/journals/laninf/article/PIIS1473-3099(15)70135-0/fulltext" class="external-link">Christian
Althaus, 2015</a> avec la sortie de la simulation.</li>
</ul></div>
</div>
</div>
</div>
<div id="accordionInstructor3" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor3" aria-expanded="false" aria-controls="collapseInstructor3">
  <h3 class="accordion-header" id="headingInstructor3">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div> Remarque de l'instructeur </h3>
</button>
<div id="collapseInstructor3" class="accordion-collapse collapse" data-bs-parent="#accordionInstructor3" aria-labelledby="headingInstructor3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb47">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load packages ---------------------------</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">epichains</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">epiparameter</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">fitdistrplus</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fit a negative binomial distribution ------------------------------------</span></span>
<span></span>
<span><span class="co"># Fitting a negative binomial distribution to the number of secondary cases</span></span>
<span><span class="va">fit.cases</span> <span class="op">&lt;-</span> <span class="fu">fitdistrplus</span><span class="fu">::</span><span class="fu">fitdist</span><span class="op">(</span><span class="va">c0</span>, <span class="st">"nbinom"</span><span class="op">)</span></span>
<span><span class="va">fit.cases</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SORTIE<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Fitting of the distribution ' nbinom ' by maximum likelihood
Parameters:
      estimate Std. Error
size 0.1814260 0.03990278
mu   0.9537995 0.19812301</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># serial interval parameters ----------------------------------------------</span></span>
<span></span>
<span><span class="va">ebola_serialinter</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epiparameter_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"ebola"</span>,</span>
<span>  epi_name <span class="op">=</span> <span class="st">"serial interval"</span>,</span>
<span>  single_epiparameter <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># simulate outbreak trajectories ------------------------------------------</span></span>
<span></span>
<span><span class="co"># Set seed for random number generator</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">645</span><span class="op">)</span></span>
<span><span class="va">sim_multiple_chains</span> <span class="op">&lt;-</span> <span class="fu">epichains</span><span class="fu">::</span><span class="fu">simulate_chains</span><span class="op">(</span></span>
<span>  n_chains <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  statistic <span class="op">=</span> <span class="st">"size"</span>,</span>
<span>  offspring_dist <span class="op">=</span> <span class="va">rnbinom</span>,</span>
<span>  mu <span class="op">=</span> <span class="va">fit.cases</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="st">"mu"</span><span class="op">]</span>,</span>
<span>  size <span class="op">=</span> <span class="va">fit.cases</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="st">"size"</span><span class="op">]</span>,</span>
<span>  generation_time <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">generate</span><span class="op">(</span>x <span class="op">=</span> <span class="va">ebola_serialinter</span>, times <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># summarise ----------------------------------------</span></span>
<span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">sim_multiple_chains</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SORTIE<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`epichains_summary` object

  [1]    9    1    2    1    1    4    1   20   14    1    1  131    1    2    1
 [16]    1    7    1    2 2889    1    1    1   13    3    1    1    1    1    1
 [31]    5    6    1    1    1    1    1    1    1    1    2    1    1    2    1
 [46]    1    1    1    1    1    1    1    1    1  335    1   11    3   24    6
 [61]    1    1    1    1    1    1    1    1    1    1    1    1    1    1  111
 [76]    1    1    1    1    1    1    2    1  544    1    1    1    3    1    2
 [91]    6    1    1    1    1    1    1    1 2091    1

 Simulated sizes:

Max: 2889
Min: 1</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb52">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># visualize ----------------------------------------</span></span>
<span></span>
<span><span class="va">sim_chains_aggregate</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">sim_multiple_chains</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># use data.frame output from &lt;epichains&gt; object</span></span>
<span>  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># Count the daily number of cases in each chain</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>day <span class="op">=</span> <span class="fu">ceiling</span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">chain</span>, <span class="va">day</span>, name <span class="op">=</span> <span class="st">"cases"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># Calculate the cumulative number of cases for each chain</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">chain</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>cumulative_cases <span class="op">=</span> <span class="fu">cumsum</span><span class="op">(</span><span class="va">cases</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim_chains_aggregate</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># Create grouped chain trajectories</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">day</span>, y <span class="op">=</span> <span class="va">cumulative_cases</span>, group <span class="op">=</span> <span class="va">chain</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Define a 100-case threshold</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylim</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Day"</span>, y <span class="op">=</span> <span class="st">"Cumulative cases"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/superspreading-simulate-rendered-unnamed-chunk-32-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Fait remarquable, même avec R0 inférieur à 1 (R = 0.95), nous pouvons
avoir des épidémies potentiellement explosives. La variation observée de
la contagiosité individuelle dans le cas d’Ebola signifie que, bien que
la probabilité d’extinction soit élevée, les nouveaux cas index ont
également le potentiel d’une repousse explosive de l’épidémie.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Points clés</h3>
<div class="callout-content">
<ul><li>Utilise <a href="https://github.com/epiverse-trace/epichains" class="external-link">epichains</a> pour simuler le potentiel de
grandes épidémies de maladies dont la distribution de la descendance est
trop dispersée.</li>
</ul></div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Chapitre Précédent et Suivant"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/superspreading-estimate.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Précédent</a>
        <a class="chapter-link float-end" href="../instructor/index.html">Suivant<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/superspreading-estimate.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Précédent: Tenir compte du
        </a>
        <a class="chapter-link float-end" href="../instructor/index.html" rel="next">
          Accueil
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>Cette leçon est soumise au <a href="CODE_OF_CONDUCT.html">Code de Conduite</a></p>
        <p>

        <a href="https://github.com/epiverse-trace/tutorials-middle-fr/edit/main/episodes/superspreading-simulate.Rmd" class="external-link">Modifier sur GitHub</a>

	
        | <a href="https://github.com/epiverse-trace/tutorials-middle-fr/blob/main/CONTRIBUTING.md" class="external-link">Contribuer</a>
        | <a href="https://github.com/epiverse-trace/tutorials-middle-fr/" class="external-link">Code Source</a></p>
				<p><a href="https://github.com/epiverse-trace/tutorials-middle-fr/blob/main/CITATION.cff" class="external-link">Citer</a> | <a href="mailto:andree.valle-campos@lshtm.ac.uk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">À propos</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Modèle publié sous licence <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> par <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Construit avec <a href="https://github.com/epiverse-trace/sandpaper/tree/patch-renv-github-bug" class="external-link">sandpaper (0.16.13.9000)</a>, <a href="https://github.com/carpentries/pegboard/tree/7dc6acfdd6233c0d124a0ecf288325edc40dd96d" class="external-link">pegboard (0.7.9)</a>, et <a href="https://github.com/epiverse-trace/varnish/tree/epiversetheme" class="external-link">varnish (1.0.7.9000)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Retour En Haut"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Retour</span> En Haut
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "@id": "https://epiverse-trace.github.io/tutorials-middle-fr/instructor/superspreading-simulate.html",
  "inLanguage": "fr",
  "dct:conformsTo": "https://bioschemas.org/profiles/LearningResource/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "forecasts, epidemic models, interventions",
  "name": "Simuler des chaînes de transmission",
  "creativeWorkStatus": "active",
  "url": "https://epiverse-trace.github.io/tutorials-middle-fr/instructor/superspreading-simulate.html",
  "identifier": "https://epiverse-trace.github.io/tutorials-middle-fr/instructor/superspreading-simulate.html",
  "dateCreated": "2025-11-02",
  "dateModified": "2025-11-02",
  "datePublished": "2025-11-02"
}

  </script><script>
		feather.replace();
	</script></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

